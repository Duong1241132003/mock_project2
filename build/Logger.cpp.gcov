        -:    0:Source:/home/duong/MediaPlayerApp/src/utils/Logger.cpp
        -:    0:Graph:/home/duong/MediaPlayerApp/build/CMakeFiles/RunTests.dir/src/utils/Logger.cpp.gcno
        -:    0:Data:/home/duong/MediaPlayerApp/build/CMakeFiles/RunTests.dir/src/utils/Logger.cpp.gcda
        -:    0:Runs:6
        -:    1:// Project includes
        -:    2:#include "utils/Logger.h"
        -:    3:
        -:    4:// System includes
        -:    5:#include <iostream>
        -:    6:#include <iomanip>
        -:    7:#include <ctime>
        -:    8:
        -:    9:namespace media_player 
        -:   10:{
        -:   11:namespace utils 
        -:   12:{
        -:   13:
      250:   14:Logger& Logger::getInstance() 
        -:   15:{
      250:   16:    static Logger instance;
      250:   17:    return instance;
        -:   18:}
        -:   19:
        6:   20:Logger::Logger() 
        6:   21:    : m_minLogLevel(LogLevel::DEBUG)
        -:   22:{
        -:   23:    // Try to open default log file
        6:   24:    setLogFile("logs/mediaplayer.log");
        6:   25:}
        -:   26:
        6:   27:Logger::~Logger() 
        -:   28:{
        6:   29:    if (m_logFile.is_open()) 
        -:   30:    {
        6:   31:        m_logFile.close();
        -:   32:    }
        6:   33:}
        -:   34:
      250:   35:void Logger::log(LogLevel level, const std::string& message) 
        -:   36:{
      250:   37:    if (level < m_minLogLevel) 
        -:   38:    {
    #####:   39:        return;
        -:   40:    }
        -:   41:    
      250:   42:    std::lock_guard<std::mutex> lock(m_mutex);
        -:   43:    
      250:   44:    std::string timestamp = getCurrentTimestamp();
      250:   45:    std::string levelStr = logLevelToString(level);
      250:   46:    std::string formattedMessage = "[" + timestamp + "] [" + levelStr + "] " + message;
        -:   47:    
        -:   48:    // Output to console
      250:   49:    std::cout << formattedMessage << std::endl;
        -:   50:    
        -:   51:    // Output to file if open
      250:   52:    if (m_logFile.is_open()) 
        -:   53:    {
      250:   54:        m_logFile << formattedMessage << std::endl;
      250:   55:        m_logFile.flush();
        -:   56:    }
      250:   57:}
        -:   58:
       30:   59:void Logger::debug(const std::string& message) 
        -:   60:{
       30:   61:    log(LogLevel::DEBUG, message);
       30:   62:}
        -:   63:
      196:   64:void Logger::info(const std::string& message) 
        -:   65:{
      196:   66:    log(LogLevel::INFO, message);
      196:   67:}
        -:   68:
       24:   69:void Logger::warning(const std::string& message) 
        -:   70:{
       24:   71:    log(LogLevel::WARNING, message);
       24:   72:}
        -:   73:
    #####:   74:void Logger::error(const std::string& message) 
        -:   75:{
    #####:   76:    log(LogLevel::ERROR, message);
    #####:   77:}
        -:   78:
    #####:   79:void Logger::fatal(const std::string& message) 
        -:   80:{
    #####:   81:    log(LogLevel::FATAL, message);
    #####:   82:}
        -:   83:
    #####:   84:void Logger::setLogLevel(LogLevel level) 
        -:   85:{
    #####:   86:    m_minLogLevel = level;
    #####:   87:}
        -:   88:
        6:   89:void Logger::setLogFile(const std::string& filepath) 
        -:   90:{
        6:   91:    std::lock_guard<std::mutex> lock(m_mutex);
        -:   92:    
        6:   93:    if (m_logFile.is_open()) 
        -:   94:    {
    #####:   95:        m_logFile.close();
        -:   96:    }
        -:   97:    
        6:   98:    m_logFile.open(filepath, std::ios::out | std::ios::app);
        -:   99:    
        6:  100:    if (!m_logFile.is_open()) 
        -:  101:    {
    #####:  102:        std::cerr << "Warning: Could not open log file: " << filepath << std::endl;
        -:  103:    }
        6:  104:}
        -:  105:
      250:  106:std::string Logger::getCurrentTimestamp() const 
        -:  107:{
      250:  108:    auto now = std::chrono::system_clock::now();
      250:  109:    auto time = std::chrono::system_clock::to_time_t(now);
        -:  110:    
      250:  111:    std::stringstream ss;
      250:  112:    ss << std::put_time(std::localtime(&time), "%Y-%m-%d %H:%M:%S");
        -:  113:    
      500:  114:    return ss.str();
      250:  115:}
        -:  116:
      250:  117:std::string Logger::logLevelToString(LogLevel level) const 
        -:  118:{
      250:  119:    switch (level) 
        -:  120:    {
       90:  121:        case LogLevel::DEBUG:   return "DEBUG";
      588:  122:        case LogLevel::INFO:    return "INFO";
       72:  123:        case LogLevel::WARNING: return "WARNING";
    #####:  124:        case LogLevel::ERROR:   return "ERROR";
    #####:  125:        case LogLevel::FATAL:   return "FATAL";
    #####:  126:        default:                return "UNKNOWN";
        -:  127:    }
        -:  128:}
        -:  129:
        -:  130:} // namespace utils
        -:  131:} // namespace media_player
